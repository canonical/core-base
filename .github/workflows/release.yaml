name: Release bases

on:
  schedule:
    - cron: "0 3 * * *"

jobs:
  build_releases:
    strategy:
      fail-fast: false
      matrix:
        base: [core22, core24]
        variant: [normal, fips]
    runs-on: ubuntu-latest
    environment: store
    steps:
      - name: Build and release ${{ matrix.base }} to edge channel
        env:
          LP_CREDENTIALS: ${{ secrets.LP_CREDENTIALS }}
          SNAPCRAFT_STORE_CREDENTIALS: ${{ secrets.SNAPCRAFT_STORE_CREDENTIALS }}
        uses: snapcore/system-snaps-cicd-tools/action-rebuild-base@main
        with:
          branch: ${{ matrix.base }}
          fips: ${{ matrix.variant == 'fips' }}
